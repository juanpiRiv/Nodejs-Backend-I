<h1>Lista de Productos</h1>

<table border="1">
    <thead>
        <tr>
            <th>Nombre</th>
            <th>Descripción</th>
            <th>Precio</th>
            <th>Categoría</th>
            <th>Stock</th>
            <th>Acciones</th>
        </tr>
    </thead>
    <tbody>
        {{#each payload}}
        <tr>
            <td>{{this.title}}</td>
            <td>{{this.description}}</td>
            <td>${{this.price}}</td>
            <td>{{this.category}}</td>
            <td>{{this.stock}}</td>
            <td>
                <a href="/products/{{this._id}}">Ver detalles</a>
                <button onclick="addToCart('{{this._id}}')">Agregar al carrito</button>
            </td>
        </tr>
        {{/each}}
    </tbody>
</table>

<!-- Paginación -->
<div>
    {{#if hasPrevPage}}
        <a href="{{prevLink}}">Anterior</a>
    {{/if}}

    Página {{page}} de {{totalPages}}

    {{#if hasNextPage}}
        <a href="{{nextLink}}">Siguiente</a>
    {{/if}}
</div>

<script>
function addToCart(productId) {
    fetch(`/api/carts/1/products/${productId}`, {  // Cambiar 1 por el ID del carrito real
        method: "POST",
        headers: { "Content-Type": "application/json" },
        body: JSON.stringify({ quantity: 1 })
    }).then(response => {
        if (response.ok) alert("Producto agregado al carrito");
    });
}
</script>
